<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('head') %>
  </head>
<body>
  <header>
    <%- include('header') %>
    <% if (username) { %>
    <nav>
      <span><%= username %></span>
      &mdash; <a href="/logout">logout</a>
      &mdash; <a href="/admin/post/new">new post</a>
      &mdash; <a href="/admin/media">media</a>
      &mdash; <a href="/admin/trash">trash</a>
      &mdash; <a href="/admin/theme">theme</a>
    </nav>
    <% } %>
    <hr>
  </header>
  <main>
    <% if (allTags.length > 0) { %>
    <div class="sort-controls">
      tag:
      <% if (!tag) { %><span class="pagination-current">all</span><% } else { %><a href="/?sort=<%= sort %>">all</a><% } %>
      <% for (const t of allTags) { %>
        <% if (t === tag) { %><span class="pagination-current"><%= t %></span><% } else { %><a href="/?sort=<%= sort %>&tag=<%= encodeURIComponent(t) %>"><%= t %></a><% } %>
      <% } %>
    </div>
    <% } %>
    <div class="sort-controls">
      sort:
      <% [["latest","latest"],["oldest","oldest"],["alpha","alphabetical"],["random","random"]].forEach(([val,label]) => { %>
        <% if (sort === val) { %><span class="pagination-current"><%= label %></span><% } else { %><a href="/?sort=<%= val %>"><%= label %></a><% } %>
      <% }) %>
    </div>
    <%- include('pagination') %>
    <% if (posts === null) { %>
      <p>Error loading posts.</p>
    <% } else if (posts.length === 0) { %>
      <p>No posts yet.</p>
    <% } else { %>
      <ul>
        <% for (const post of posts) { %>
          <li>
            <h3><a href="/post/<%= post.slug %>">&quot;<%= post.slug %>&quot;</a><% if (username) { %> &mdash; <a href="/admin/post/<%= post.slug %>/edit">edit</a><% } %></h3>
            modified <em><%= post.ts %></em>
          </li>
        <% } %>
      </ul>
    <% } %>
    <%- include('pagination') %>
  </main>
  <footer>
    <%- footer %>
  </footer>
</body>
</html>
